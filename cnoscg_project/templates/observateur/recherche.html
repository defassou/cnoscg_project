
{% extends 'main.html' %}
{% block content %}
{% load static %}

<div class="container">


<h3 class="mb-4">üîç Rechercher un observateur</h3>

<form method="POST">

    {% csrf_token %}
    <div class="input-group mb-3">
        <input type="text" name="telephone" class="form-control"
               placeholder="Entrer votre num√©ro de t√©l√©phone" required>
        <button class="btn btn-primary">Rechercher</button>

      <input id="tel" class="form-control" placeholder="Num√©ro de t√©l√©phone">
        <button onclick="chercher()" class="btn btn-success mt-2">Rechercher</button>

    <div id="resultat"></div>

        <script>
            function chercher() {
                let tel = document.getElementById("tel").value;

                fetch(/api/recherche/?telephone=${tel})
                .then(res => res.json())
                .then(data => {
                        if (data.error) {
                            document.getElementById("resultat").innerHTML =
                                <div class="alert alert-danger">${data.error}</div>;
                        } else {
                            document.getElementById("resultat").innerHTML = `
                                <div class="card mt-3">
                                    <div class="card-body">
                                        <p><b>Nom:</b> ${data.nom}</p>
                                        <p><b>Pr√©nom:</b> ${data.prenom}</p>
                                        <p><b>R√©gion:</b> ${data.region}</p>
                                        <p><b>Bureau:</b> ${data.prefecture}</p>
                                        <p><b>Statut:</b> ${data.commune}</p>
                                        <p><b>Statut:</b> ${data.picture}</p>
                                    </div>
                                </div>`;
                            }
                    });
               }
        </script>
    </div>
</form>

{% if erreur %}
<div class="alert alert-danger">{{ erreur }}</div>
{% endif %}

{% if observateur %}
<div class="card mt-4">
    <div class="card-header bg-success text-white">
        Informations de l‚Äôobservateur
    </div>
    <div class="card-body">
        <p><strong>Nom :</strong> {{ observateur.nom }}</p>
        <p><strong>Pr√©nom :</strong> {{ observateur.prenom }}</p>
        <p><strong>T√©l√©phone :</strong> {{ observateur.region }}</p>
        <p><strong>R√©gion :</strong> {{ observateur.prefecture }}</p>
        <p><strong>Bureau de vote :</strong> {{ observateur.commune }}</p>
        <p><strong>Statut :</strong> {{ observateur.picture }}</p>
    </div>
</div>

{% endif %}
</div>
{% endblock %}
